!function(t){"use strict";function e(t,e){if("string"!=typeof t||"function"!=typeof e)throw new Error("First param should be a String, Second parameter should be an function")}function n(t){t=t||{},this._groups={},this._eventMap={},this._registredListenersCount=0,this._maxListeners=t.maxListeners||10,this._logger=t.logger}var i={each:function(t,e,n){var i,r;if(Array.isArray(t))for(i=0,r=t.length;r>i&&!e.call(n,t[i],i,t);i++);else if("object"==typeof t){var s=Object.keys(t);for(i=0,r=s.length;r>i;i++){var o=s[i];if(e.call(n,t[o],o,t))break}}},extend:function(t,e){this.each(e,function(e,n){t[n]=e})},indexOf:function(t,e){var n=-1;return this.each(t,function(t,i,r){return e(t,i,r)?(n=i,!0):void 0}),n},contains:function(t,e){return!!~t.indexOf(e)},arrayCopy:function(t){return Array.prototype.slice.call(t)},notGroup:function(t){return t.group!==this},notEvent:function(t){return t!==this}};i.extend(n.prototype,{_on:function(t,n){e(t,n);var r,s=this._eventMap;if(i.contains(t,".")){var o=t.split("."),f=this._groups;r=o[1],t=o[0],f[r]?f[r].push(t):f[r]=[t]}s[t]?s[t].push({group:r,handler:n}):s[t]=[{group:r,handler:n}],this._registredListenersCount++,this._registredListenersCount>this._maxListeners&&this._logger&&this._logger("Potentially memory leak was detected, max listeners count ["+this._maxListeners+"], registred ["+this._registredListenersCount+"]")},_off:function(t,e){var n;if(i.contains(t,".")){var r=t.split(".");t=r[0],n=r[1]}t&&n?this._offEventGroup(t,n):n?this._offGroup(n):this._offEvent(t,e)},_offEventGroup:function(t,e){if(this._groups[e]&&this._eventMap[t]){var n=this._eventMap[t].length;this._eventMap[t]=this._eventMap[t].filter(i.notGroup,e);var r=this._eventMap[t].length;this._groups[e]=this._groups[e].filter(i.notEvent,t),this._registredListenersCount-=n-r}},_offGroup:function(t){if(this._groups[t]){var e=i.arrayCopy(this._groups[t]);e.forEach(function(e){this._offEventGroup(e,t)},this),delete this._groups[t]}},_offEvent:function(t,e){if("function"==typeof e&&this._eventMap[t]){var n=i.indexOf(this._eventMap[t],function(t){return t.handler===e});~n&&this._eventMap[t].splice(n,1),this._registredListenersCount--}else if(this._eventMap[t]){var r=this._eventMap[t].length;this._eventMap[t].forEach(function(e){if(e.group){var n=this._groups[e.group],i=n.indexOf(t);n.splice(i,1)}},this),this._registredListenersCount-=r,delete this._eventMap[t]}}}),i.extend(n.prototype,{on:function(t,e){Array.isArray(t)?i.each(t,function(t){this._on(t,e)},this):this._on(t,e)},off:function(t,e){Array.isArray(t)?i.each(t,function(t){this._off(t,e)},this):this._off(t,e)},once:function(t,e){function n(){try{e.apply(this,arguments)}finally{i.off(t,n)}}var i=this;i.on(t,n)},emit:function(t){if(this._eventMap[t]){var e=Array.prototype.slice.call(arguments,1);i.each(this._eventMap[t],function(t){t.handler.apply(null,e)},this)}},getMaxListeners:function(){return this._maxListeners},setMaxListeners:function(t){t>0&&(this._maxListeners=t)},toString:function(){return"[object EventEmitter]"}}),"undefined"!=typeof module?module.exports=n:"undefined"!=typeof exports?exports.EventEmitter=n:t.EventEmitter=n}(new Function("return this")());