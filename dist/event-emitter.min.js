!function(t){"use strict";function n(t,n){if("string"!=typeof t||"function"!=typeof n)throw new Error("First param should be a String, Second parameter should be an function")}function e(t){t=t||{},this._groups={},this._eventMap={},this._registredListenersCount=0,this._maxListeners=t.maxListeners||20,this._logger=t.logger||console}var i={each:function(t,n,e){var i,r;if(Array.isArray(t))for(i=0,r=t.length;r>i&&!n.call(e,t[i],i,t);i++);else if("object"==typeof t){var o=Object.keys(t);for(i=0,r=o.length;r>i;i++){var s=o[i];if(n.call(e,t[s],s,t))break}}},extend:function(t,n){this.each(n,function(n,e){t[e]=n})},indexOf:function(t,n){var e=-1;return this.each(t,function(t,i,r){return n(t,i,r)?(e=i,!0):void 0}),e},contains:function(t,n){return!!~t.indexOf(n)},arrayCopy:function(t){return Array.prototype.slice.call(t)},notGroup:function(t){return t.group!==this},notEvent:function(t){return t!==this}};i.extend(e.prototype,{_on:function(t,e){n(t,e);var r,o=this._eventMap;if(i.contains(t,".")){var s=t.split("."),f=this._groups;r=s[1],t=s[0],f[r]?f[r].push(t):f[r]=[t]}o[t]?o[t].push({group:r,handler:e}):o[t]=[{group:r,handler:e}],this._registredListenersCount++},_off:function(t,n){var e;if(i.contains(t,".")){var r=t.split(".");t=r[0],e=r[1]}t&&e?this._offEventGroup(t,e):e?this._offGroup(e):this._offEvent(t,n)},_offEventGroup:function(t,n){var e=this._eventMap[t].length;this._eventMap[t]=this._eventMap[t].filter(i.notGroup,n);var r=this._eventMap[t].length;this._groups[n]=this._groups[n].filter(i.notEvent,t),this._registredListenersCount-=e-r},_offGroup:function(t){var n=i.arrayCopy(this._groups[t]);n.forEach(function(n){this._offEventGroup(n,t)},this),delete this._groups[t]},_offEvent:function(t,n){if("function"==typeof n){var e=i.indexOf(this._eventMap[t],function(t){return t.handler===n});~e&&this._eventMap[t].splice(e,1),this._registredListenersCount--}else{var r=this._eventMap[t].length;this._eventMap[t].forEach(function(n){if(n.group){var e=this._groups[n.group],i=e.indexOf(t);e.splice(i,1)}},this),this._registredListenersCount-=r,delete this._eventMap[t]}}}),i.extend(e.prototype,{on:function(t,n){Array.isArray(t)?i.each(t,function(t){this._on(t,n)},this):this._on(t,n)},off:function(t,n){Array.isArray(t)?i.each(t,function(t){this._off(t,n)},this):this._off(t,n)},once:function(t,n){function e(){try{n.apply(this,arguments)}finally{i.off(t,e)}}var i=this;i.on(t,e)},emit:function(t){if(this._eventMap[t]){var n=Array.prototype.slice.call(arguments,1);i.each(this._eventMap[t],function(t){t.handler.apply(null,n)},this)}},getMaxListeners:function(){return this._maxListeners},setMaxListeners:function(t){t>0&&(this._maxListeners=t)},toString:function(){return"[object EventEmitter]"}}),"undefined"!=typeof module?module.exports=e:"undefined"!=typeof exports?exports.EventEmitter=e:t.EventEmitter=e}(new Function("return this")());